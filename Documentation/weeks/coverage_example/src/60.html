<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>p:\stuff\projects\minigamesproject\minigamesproject\assets\_assets\scripts\games\tankgame\powerups\tankpowerup_shield_shield.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class TankPowerup_Shield_Shield : MonoBehaviour {

    private Transform player;
    private TankPlayer tPlayer;
    private new SphereCollider collider;
    private HashSet&lt;GameObject&gt; bullets;

    private bool grown;
    private Vector3 targetScale;
    private Color targetColor;

    // Start is called before the first frame update
    public void Initialize(Transform player) {
        this.player = player;
        tPlayer = player.GetComponent&lt;TankPlayer&gt;();
        collider = GetComponent&lt;SphereCollider&gt;();
        Physics.IgnoreCollision(collider, player.GetChild(0).GetComponent&lt;BoxCollider&gt;(), true);
        bullets = new HashSet&lt;GameObject&gt;();

        InitGrow();
    }
    private void InitGrow() {
        targetScale = transform.localScale;
        targetColor = GetComponent&lt;Renderer&gt;().material.color;

        transform.localScale = targetScale * 0.01f;
        //GetComponent&lt;Renderer&gt;().material.color;
    }

    // Update is called once per frame
    void Update() {
        transform.position = player.position;

        if (!grown) {
            Grow();
        }
    }
    private void Grow() {
        transform.localScale += Time.deltaTime * targetScale;
        Vector3 scale = transform.localScale;
        if (scale.x &gt;= targetScale.x &amp;&amp; scale.y &gt;= targetScale.y &amp;&amp; scale.z &gt;= targetScale.z) {
            transform.localScale = targetScale;
            grown = true;
        }
    }

    private void OnTriggerEnter(Collider other) {

        Vector3 pos = other.transform.position;

        TankBullet bullet = other.GetComponent&lt;TankBullet&gt;();

        if (bullet == null) {
            print(&quot;no bullet&quot;);
            return;
        }

        if (bullet.Owner.gameObject == tPlayer.gameObject) {
            if (!bullets.Contains(bullet.gameObject)) {
                bullets.Add(bullet.gameObject);
                print(&quot;Own bullet, returning&quot;);
                //return;
            }
        }

        print(&quot;Shield bounce: &quot; + GetNormal(pos));

        bullet.SetDirection(GetNormal(pos));
    }

    private bool InsideCollider(Vector3 pos) {
        return collider.bounds.Contains(pos);
    }

    private Vector3 GetNormal(Vector3 pos) {
        print(&quot;P pos: &quot; + player.transform.position);
        print(&quot;B pos: &quot; + pos);
        return ResetY(pos) - ResetY(player.position);
    }
    private Vector3 ResetY(Vector3 v) {
        v.y = 0;
        return v;
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[17,46,17,47,0],[18,9,18,30,0],[19,9,19,53,0],[20,9,20,51,0],[21,9,21,97,0],[22,9,22,45,0],[24,9,24,20,0],[25,5,25,6,0],[26,29,26,30,0],[27,9,27,44,0],[28,9,28,63,0],[30,9,30,52,0],[32,5,32,6,0],[35,19,35,20,0],[36,9,36,46,0],[38,9,38,20,0],[38,21,38,22,0],[39,13,39,20,0],[40,9,40,10,0],[41,5,41,6,0],[42,25,42,26,0],[43,9,43,62,0],[44,9,44,46,0],[45,9,45,94,0],[45,95,45,96,0],[46,13,46,48,0],[47,13,47,26,0],[48,9,48,10,0],[49,5,49,6,0],[51,49,51,50,0],[53,9,53,48,0],[55,9,55,62,0],[57,9,57,28,0],[57,29,57,30,0],[58,13,58,32,0],[59,13,59,20,0],[62,9,62,59,0],[62,60,62,61,0],[63,13,63,54,0],[63,55,63,56,0],[64,17,64,48,0],[65,17,65,48,0],[67,13,67,14,0],[68,9,68,10,0],[70,9,70,51,0],[72,9,72,45,0],[73,5,73,6,0],[75,46,75,47,0],[76,9,76,46,0],[77,5,77,6,0],[79,44,79,45,0],[80,9,80,54,0],[81,9,81,32,0],[82,9,82,54,0],[83,5,83,6,0],[84,39,84,40,0],[85,9,85,17,0],[86,9,86,18,0],[87,5,87,6,0]]);
    </script>
  </body>
</html>