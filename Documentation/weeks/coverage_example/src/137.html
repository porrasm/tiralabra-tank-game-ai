<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>p:\stuff\projects\minigamesproject\minigamesproject\assets\_assets\scripts\bearded man studios\modules\chat\chatmanager.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using BeardedManStudios.Forge.Networking;
using BeardedManStudios.Forge.Networking.Generated;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;

public class ChatManager : ChatManagerBehavior
{
	public Transform contentTransform;
	public GameObject messageLabel;
	public GameObject eventSystem;

	public InputField messageInput;

	private List&lt;Text&gt; messageLabels = new List&lt;Text&gt;();
	public int maxMessages = 100;

	private void Awake()
	{
		Instantiate(eventSystem);
	}

	public override void SendMessage(RpcArgs args)
	{
		string username = args.GetNext&lt;string&gt;();
		string message = args.GetNext&lt;string&gt;();

		Text label = null;
		if (messageLabels.Count == maxMessages)
		{
			label = messageLabels[0];
			messageLabels.RemoveAt(0);
			label.transform.SetAsLastSibling();
		}
		else
			label = (Instantiate(messageLabel, contentTransform) as GameObject).GetComponent&lt;Text&gt;();

		messageLabels.Add(label);
		label.text = username + &quot;: &quot; + message;
	}

	public void SendMessage()
	{
		string message = messageInput.text.Trim();
		if (string.IsNullOrEmpty(message))
			return;

		string name = networkObject.Networker.Me.Name;

		if (string.IsNullOrEmpty(name))
			name = NetWorker.InstanceGuid.ToString().Substring(0, 5);

		networkObject.SendRpc(RPC_SEND_MESSAGE, Receivers.All, name, message);
		messageInput.text = &quot;&quot;;
		messageInput.Select();
	}
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[15,2,15,54,0],[16,2,16,31,0],[19,2,19,3,0],[20,3,20,28,0],[21,2,21,3,0],[24,2,24,3,0],[25,3,25,44,0],[26,3,26,43,0],[28,3,28,21,0],[29,3,29,42,0],[30,3,30,4,0],[31,4,31,29,0],[32,4,32,30,0],[33,4,33,39,0],[34,3,34,4,0],[36,4,36,93,0],[38,3,38,28,0],[39,3,39,42,0],[40,2,40,3,0],[43,2,43,3,0],[44,3,44,45,0],[45,3,45,37,0],[46,4,46,11,0],[48,3,48,49,0],[50,3,50,34,0],[51,4,51,61,0],[53,3,53,73,0],[54,3,54,26,0],[55,3,55,25,0],[56,2,56,3,0]]);
    </script>
  </body>
</html>