<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>p:\stuff\projects\minigamesproject\minigamesproject\assets\_assets\tests\pathfindingastartest.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Collections.Generic;
using NUnit.Framework;
using UnityEngine;
using UnityEngine.TestTools;

namespace Tests {

    public class PathfindingAStarTest {

        private byte[,] level;
        private TankMazeGenerator generator;
        private TankAIPathfinding pf;

        [SetUp]
        public void Setup() {

            TankSettings.LevelWidth = 10;
            TankSettings.LevelHeight = 10;

            generator = new TankMazeGenerator();

            List&lt;TankLevelGenerator.Step&gt; steps;

            generator.GenerateMaze(out steps, out level);

            Init();
        }
        private void Init() {
            pf = new TankAStarPath(level);
        }

        [Test]
        public void RouteToEndIsStraight() {

            PathfindingHelper.ClearLevel(out level);
            Init();

            IntCoords start = new IntCoords();

            // Right
            IntCoords end = new IntCoords(9, 0);

            Vector[] route = pf.FindPath(start, end);

            PathfindingHelper.TestRoute(start, end, route);

            foreach (Vector v in route) {
                IntCoords c = Vector.PositionToCoords(v);
            }

            for (int i = 0; i &lt; 10; i++) {
                PathfindingHelper.TestCoords(new IntCoords(i, 0), route[i], &quot;Route to right was not straight&quot;);
            }

            // Up
            end = new IntCoords(0, 9);

            route = pf.FindPath(start, end);

            PathfindingHelper.TestRoute(start, end, route);

            for (int i = 0; i &lt; 10; i++) {
                PathfindingHelper.TestCoords(new IntCoords(0, i), route[i], &quot;Route to up was not straight&quot;);
            }

            // Up-Right
            end = new IntCoords(9, 9);

            route = pf.FindPath(start, end);

            PathfindingHelper.TestRoute(start, end, route);

            for (int i = 0; i &lt; 10; i++) {
                PathfindingHelper.TestCoords(new IntCoords(i, i), route[i], &quot;Route to up-right was not straight&quot;);
            }
        }

        [Test]
        public void RouteIsFoundToEveryCell() {

            IntCoords start = new IntCoords();

            void To(int x, int y) {

                IntCoords end = new IntCoords(x, y);

                Vector[] route = pf.FindPath(start, end);

                PathfindingHelper.TestRoute(start, end, route);
            }

            PathfindingHelper.IterateLevel(To);
        }
        [Test]
        public void RouteIsFoundFromEveryCell() {

            IntCoords end = new IntCoords(0, 0);

            void From(int x, int y) {

                IntCoords start = new IntCoords(x, y);

                Vector[] route = pf.FindPath(start, end);

                PathfindingHelper.TestRoute(start, end, route);
            }

            PathfindingHelper.IterateLevel(From);
        }
        [Test]
        public void RouteIsFoundToEveryCellFromEveryCell() {

            void From(int x, int y) {

                IntCoords start = new IntCoords(x, y);

                void To(int x2, int y2) {

                    IntCoords end = new IntCoords(x2, y2);

                    Vector[] route = pf.FindPath(start, end);

                    PathfindingHelper.TestRoute(start, end, route);
                }

                PathfindingHelper.IterateLevel(To);
            }

            PathfindingHelper.IterateLevel(From);
        }   
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[17,29,17,30,1],[19,13,19,42,1],[20,13,20,43,1],[22,13,22,49,1],[26,13,26,58,1],[28,13,28,20,1],[29,9,29,10,1],[30,29,30,30,1],[31,13,31,43,1],[32,9,32,10,1],[35,44,35,45,1],[37,13,37,53,1],[38,13,38,20,1],[40,13,40,47,1],[43,13,43,49,1],[45,13,45,54,1],[47,13,47,60,1],[49,13,49,20,1],[49,22,49,30,1],[49,31,49,33,1],[49,34,49,39,1],[49,41,49,42,1],[50,17,50,58,1],[51,13,51,14,1],[53,18,53,27,1],[53,29,53,35,1],[53,37,53,40,1],[53,42,53,43,1],[54,17,54,112,1],[55,13,55,14,1],[58,13,58,39,1],[60,13,60,45,1],[62,13,62,60,1],[64,18,64,27,1],[64,29,64,35,1],[64,37,64,40,1],[64,42,64,43,1],[65,17,65,109,1],[66,13,66,14,1],[69,13,69,39,1],[71,13,71,45,1],[73,13,73,60,1],[75,18,75,27,1],[75,29,75,35,1],[75,37,75,40,1],[75,42,75,43,1],[76,17,76,115,1],[77,13,77,14,1],[78,9,78,10,1],[81,47,81,48,1],[83,13,83,47,1],[85,35,85,36,1],[87,17,87,53,1],[89,17,89,58,1],[91,17,91,64,1],[92,13,92,14,1],[94,13,94,48,1],[95,9,95,10,1],[97,49,97,50,1],[99,13,99,49,1],[101,37,101,38,1],[103,17,103,55,1],[105,17,105,58,1],[107,17,107,64,1],[108,13,108,14,1],[110,13,110,50,1],[111,9,111,10,1],[113,60,113,61,1],[115,37,115,38,1],[117,17,117,55,1],[119,41,119,42,1],[121,21,121,59,1],[123,21,123,62,1],[125,21,125,68,1],[126,17,126,18,1],[128,17,128,52,1],[129,13,129,14,1],[131,13,131,50,1],[132,9,132,10,1]]);
    </script>
  </body>
</html>